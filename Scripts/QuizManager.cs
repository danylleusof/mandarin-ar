using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class QuizManager : MonoBehaviour
{
#pragma warning disable 649
    //ref to the QuizGameUI script
    [SerializeField] private QuizGameUI quizGameUI;
    //ref to the scriptableobject file
    [SerializeField] private QuizDataScriptable dataScriptable;
#pragma warning restore 649
    //questions data
    private List<Question> questions;
    //current question data
    private Question selectedQuetion = new Question();

    public AudioSource Source;
    public AudioClip betul;
    public AudioClip salah;

    private void Start()
    {
        //set the questions data
        questions = new List<Question>();
        questions.AddRange(dataScriptable.questions);
        //select the question
        SelectQuestion();
    }

    /// <summary>
    /// Method used to randomly select the question form questions data
    /// </summary>
    private void SelectQuestion()
    {
        //get the random number
        int val = Random.Range(0, questions.Count);
        //set the selectedQuetion
        selectedQuetion = questions[val];
        //send the question to quizGameUI
        quizGameUI.SetQuestion(selectedQuetion);
    }

    /// <summary>
    /// Method called to check the answer is correct or not
    /// </summary>
    /// <param name="selectedOption">answer string</param>
    /// <returns></returns>
    public bool Answer(string selectedOption)
    {
        //set default to false
        bool correct = false;
        //if selected answer is similar to the correctAns
        if (selectedQuetion.correctAns == selectedOption)
        {
            //Yes, Ans is correct
            correct = true;
            ScoringSystem.scorePoints += 10;
            Source.clip = betul;
            Source.Play();

        }
        else
        {
            //No, Ans is wrong
            Source.clip = salah;
            Source.Play();
        }
        //call SelectQuestion method again after 1s
        Invoke("SelectQuestion", 0.4f);
        //return the value of correct bool
        return correct;
    }
}

//Datastructure for storeing the quetions data
[System.Serializable]
public class Question
{
    public string questionInfo;         //question text
    public QuestionType questionType;   //type
    public Sprite questionImage;        //image for Image Type
    public AudioClip audioClip;         //audio for audio type
    public UnityEngine.Video.VideoClip videoClip;   //video for video type
    public List<string> options;        //options to select
    public string correctAns;           //correct option
}

[System.Serializable]
public enum QuestionType
{
    TEXT,
    IMAGE,
    AUDIO,
    VIDEO
}